{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","spinning","isUpoading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"mkBAOOA,EAAWC,IAAXD,QAGDE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KAiHIC,EA5GGC,aAAS,WAAO,IAAD,EACCC,cAAzBC,EADwB,EACxBA,WAAYC,EADY,EACZA,UACbC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cAEE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAepGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,qDACT,IAETC,OAAOP,KAAOA,EACT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,+BACP,IAGT9B,EAAW+B,SACRC,MAAK,SAACrB,GACLsB,QAAQC,IAAI,4BACZD,QAAQC,IAAIvB,MACXwB,OAAM,WACTF,QAAQC,IAAI,gCAEP,IAfLV,IAAQM,MAAM,0EACP,MAkBb,OACE,gCACE,cAAC,IAAD,CAAMM,SAAUpC,EAAWqC,WAA3B,SACE,eAACjD,EAAD,2BAAa4B,GAAb,cACE,mBAAGsB,UAAU,uBAAb,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,oEACA,mBAAGA,UAAU,kBAAb,uHAMFtC,EAAWW,WAAa,eAACrB,EAAD,WACtB,cAACG,EAAD,uCACA,+BACE,0DACA,6BAAI,mBAAG+C,OAAO,SACPC,KAAMzC,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IADzD,SAC+Db,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAEnH,oDACA,6BAAKb,EAAW0C,WAChB,0DACA,6BACE,cAAC/C,EAAD,CAAOgD,IAAK3C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAE9D,0DACA,+BACE,uBAAO+B,IAAK1C,EAAM2C,SArEN,WACtBZ,QAAQC,IAAI,sBACZD,QAAQC,IAAIhC,EAAK4C,QAAQC,OACzB1C,EAAMG,SAASN,EAAK4C,QAAQC,QAkE2BC,YAAY,qDACzD,uBAAOJ,IAAKxC,EAAMyC,SAhEL,WACvBxC,EAAMK,UAAUN,EAAK0C,QAAQC,QA+D2BC,YAAY,wDAE5D,6BACE,mBAAGR,OAAO,SAASC,KAAMpC,EAAM4C,QAA/B,SAAyC5C,EAAM4C,kBAGzC,W,2KC1HpB,IAAMC,EAAO3D,IAAOC,IAAV,KAmBKK,EAXGC,aAAS,YAAmB,IAAhBqD,EAAe,EAAfA,SACpBlD,EAAcF,cAAdE,UACR,OACE,mCAEIA,EAAUsB,YAAc,KAAO,cAAC2B,EAAD,UAAOC,SCbxCC,EAAOtD,aAAS,WAClB,OACE,qCACE,cAAC,EAAD,mGACA,cAACuD,EAAD,UAMOD","file":"static/js/9.afee9e52.chunk.js","sourcesContent":["import React, {useRef} from 'react'\r\nimport {useStores} from '../stores'\r\nimport {observer, useLocalStore} from 'mobx-react'\r\nimport {Upload, message, Spin} from 'antd'\r\nimport {InboxOutlined} from '@ant-design/icons'\r\nimport styled from 'styled-components'\r\n\r\nconst {Dragger} = Upload\r\n\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`\r\n\r\n\r\nconst Component = observer(() => {\r\n  const {ImageStore, UserStore} = useStores()\r\n  const ref1 = useRef()\r\n  const ref2 = useRef()\r\n\r\n  const store = useLocalStore(() => ({\r\n    width: null,\r\n    setWidth(width) {\r\n      store.width = width\r\n    },\r\n    get widthStr() {\r\n      return store.width ? `/w/${store.width}` : ''\r\n    },\r\n    height: null,\r\n    setHeight(height) {\r\n      store.height = height\r\n    },\r\n    get heightStr() {\r\n      return store.height ? `/h/${store.height}` : ''\r\n    },\r\n    get fullStr() {\r\n      //?imageView2/0/w/800/h/400)\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n\r\n  }))\r\n\r\n  const bindWidthChange = () => {\r\n    console.log('bindWidthChange...')\r\n    console.log(ref1.current.value)\r\n    store.setWidth(ref1.current.value)\r\n  }\r\n\r\n  const bindHeightChange = () => {\r\n    store.setHeight(ref2.current.value)\r\n  }\r\n\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      ImageStore.setFile(file)\r\n      ImageStore.setFilename(file.name)\r\n      if (UserStore.currentUser === null) {\r\n        message.warning('请先登录再上传！')\r\n        return false\r\n      }\r\n      window.file = file\r\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n        message.error('只能上传png/svg/jpg/gif格式的图片')\r\n        return false\r\n      }\r\n      if (file.size > 1024 * 1024) {\r\n        message.error('图片最大1M')\r\n        return false\r\n      }\r\n\r\n      ImageStore.upload()\r\n        .then((serverFile) => {\r\n          console.log('上传成功')\r\n          console.log(serverFile)\r\n        }).catch(() => {\r\n        console.log('上传失败')\r\n      })\r\n      return false\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Spin spinning={ImageStore.isUpoading}>\r\n        <Dragger {...props}>\r\n          <p className=\"ant-upload-drag-icon\">\r\n            <InboxOutlined />\r\n          </p>\r\n          <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\r\n          <p className=\"ant-upload-hint\">\r\n            仅支持.png/.gif/.jpg/.svg格式的图片，图片最大1M\r\n          </p>\r\n        </Dragger>\r\n      </Spin>\r\n      {\r\n        ImageStore.serverFile ? <Result>\r\n          <H1>上传结果</H1>\r\n          <dl>\r\n            <dt>线上地址</dt>\r\n            <dd><a target=\"_blank\"\r\n                   href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\r\n            </dd>\r\n            <dt>文件名</dt>\r\n            <dd>{ImageStore.filename}</dd>\r\n            <dt>图片预览</dt>\r\n            <dd>\r\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url} />\r\n            </dd>\r\n            <dt>更多尺寸</dt>\r\n            <dd>\r\n              <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\" />\r\n              <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\" />\r\n            </dd>\r\n            <dd>\r\n              <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\r\n            </dd>\r\n          </dl>\r\n        </Result> : null\r\n      }\r\n    </div>\r\n  )\r\n})\r\nexport default Component","import React from 'react';\r\nimport { useStores } from '../stores';\r\nimport { observer } from 'mobx-react';\r\nimport styled from 'styled-components';\r\n\r\nconst Tips = styled.div`\r\n  background: #32CD32;\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color: #fff;\r\n  border-radius: 4px;\r\n`;\r\n\r\nconst Component = observer(({ children }) => {\r\n  const { UserStore } = useStores();\r\n  return (\r\n    <>\r\n      {\r\n        UserStore.currentUser ? null : <Tips>{children}</Tips>\r\n      }\r\n    </>\r\n  );\r\n});\r\n\r\nexport default Component;","import React from 'react'\r\nimport {observer} from 'mobx-react'\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n    return (\r\n      <>\r\n        <Tips>温馨提示：请先登录后再上传！</Tips>\r\n        <Uploader />\r\n      </>\r\n    )\r\n  }\r\n)\r\n\r\nexport default Home\r\n"],"sourceRoot":""}